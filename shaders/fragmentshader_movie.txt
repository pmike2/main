#version 410 core

uniform sampler3D movie[8];
uniform sampler2DArray alpha;
uniform sampler1DArray movie_time;
uniform sampler1D index_time;
uniform int screen_width;
uniform int screen_height;

out vec4 color;

void main() {
	vec2 uv = vec2(gl_FragCoord.x/ screen_width, gl_FragCoord.y/ screen_height);
	
	color= vec4(0.0);
	for (int i=0; i<8; i++) {
		vec4 k= texture(index_time, float(i)/ 8.0);
		vec4 frame= texture(movie_time, vec2(k.r, float(i)));
		vec4 tex= texture(movie[i], vec3(uv, frame.r));
		vec4 a= texture(alpha, vec3(uv, i));
		color+= vec4(vec3(tex), a.r);
	}
}
